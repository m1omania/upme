# –†–∞–∑–º–µ—â–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

## –ê–Ω–∞–ª–∏–∑ –≤–∞—à–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

–°—É–¥—è –ø–æ —Å–∫—Ä–∏–Ω—à–æ—Ç—É:
- **CPU**: 1 —è–¥—Ä–æ √ó 2000 –ú–ì—Ü (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 0%)
- **RAM**: 2 –ì–ë (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 3% = 61 –ú–ë)
- **–î–∏—Å–∫**: 14 –ì–ë SSD (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 24% = 3.23 –ì–ë)
- **–û–°**: Ubuntu 24.04 LTS

**–í—ã–≤–æ–¥**: –†–µ—Å—É—Ä—Å–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –¥–≤—É—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤! ‚úÖ

---

## –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–∑–º–µ—â–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†–∞–∑–Ω—ã–µ –ø–æ—Ä—Ç—ã (–ø—Ä–æ—Å—Ç–æ–π)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –ü—Ä–æ–µ–∫—Ç 1: `–≤–∞—à-–¥–æ–º–µ–Ω.ru` ‚Üí –ø–æ—Ä—Ç 3001
- –ü—Ä–æ–µ–∫—Ç 2 (UpMe): `–≤–∞—à-–¥–æ–º–µ–Ω.ru:3002` –∏–ª–∏ `upme.–≤–∞—à-–¥–æ–º–µ–Ω.ru` ‚Üí –ø–æ—Ä—Ç 3002

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ–µ–∫—Ç

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ù—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ—Ä—Ç –≤ URL (–µ—Å–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø–æ–¥–¥–æ–º–µ–Ω)

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†–∞–∑–Ω—ã–µ –ø–æ–¥–¥–æ–º–µ–Ω—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –ü—Ä–æ–µ–∫—Ç 1: `–≤–∞—à-–¥–æ–º–µ–Ω.ru` ‚Üí –ø–æ—Ä—Ç 3001
- –ü—Ä–æ–µ–∫—Ç 2 (UpMe): `upme.–≤–∞—à-–¥–æ–º–µ–Ω.ru` ‚Üí –ø–æ—Ä—Ç 3002

**–ü–ª—é—Å—ã:**
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–µ URL –±–µ–∑ –ø–æ—Ä—Ç–æ–≤
- ‚úÖ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–∏–¥
- ‚úÖ –õ–µ–≥–∫–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç—ã

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å DNS –¥–ª—è –ø–æ–¥–¥–æ–º–µ–Ω–∞

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –†–∞–∑–Ω—ã–µ –ø—É—Ç–∏ (–µ—Å–ª–∏ –æ–¥–∏–Ω –¥–æ–º–µ–Ω)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –ü—Ä–æ–µ–∫—Ç 1: `–≤–∞—à-–¥–æ–º–µ–Ω.ru/`
- –ü—Ä–æ–µ–∫—Ç 2: `–≤–∞—à-–¥–æ–º–µ–Ω.ru/upme/`

**–ü–ª—é—Å—ã:**
- ‚úÖ –û–¥–∏–Ω –¥–æ–º–µ–Ω
- ‚úÖ –ù–µ –Ω—É–∂–Ω—ã –ø–æ–¥–¥–æ–º–µ–Ω—ã

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –°–ª–æ–∂–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Ä–æ—É—Ç–æ–≤

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: –ü–æ–¥–¥–æ–º–µ–Ω—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```
/var/www/
‚îú‚îÄ‚îÄ project1/          # –í–∞—à —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ–µ–∫—Ç
‚îÇ   ‚îú‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ (–ø–æ—Ä—Ç 3001)
‚îÇ
‚îî‚îÄ‚îÄ upme/              # –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç UpMe
    ‚îú‚îÄ‚îÄ backend/
    ‚îÇ   ‚îú‚îÄ‚îÄ dist/
    ‚îÇ   ‚îú‚îÄ‚îÄ data/
    ‚îÇ   ‚îú‚îÄ‚îÄ logs/
    ‚îÇ   ‚îî‚îÄ‚îÄ .env
    ‚îú‚îÄ‚îÄ frontend/
    ‚îÇ   ‚îî‚îÄ‚îÄ dist/
    ‚îî‚îÄ‚îÄ (–ø–æ—Ä—Ç 3002)
```

---

## –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ UpMe

–ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:

```bash
# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
cd /Users/mio/Desktop/upme
npm run build
```

### –®–∞–≥ 2: –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è UpMe
ssh user@–≤–∞—à-—Å–µ—Ä–≤–µ—Ä
sudo mkdir -p /var/www/upme
sudo chown $USER:$USER /var/www/upme

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã (—Å –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞)
scp -r backend/dist user@–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:/var/www/upme/backend/
scp -r frontend/dist user@–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:/var/www/upme/frontend/
scp backend/package.json user@–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:/var/www/upme/backend/
scp backend/.env user@–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:/var/www/upme/backend/
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
ssh user@–≤–∞—à-—Å–µ—Ä–≤–µ—Ä
cd /var/www/upme/backend
npm install --production
```

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env –¥–ª—è UpMe

```bash
cd /var/www/upme/backend
nano .env
```

–û–±–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
PORT=3002
JWT_SECRET=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç
HH_CLIENT_ID=–≤–∞—à_id
HH_CLIENT_SECRET=–≤–∞—à_secret
HH_REDIRECT_URI=https://upme.–≤–∞—à-–¥–æ–º–µ–Ω.ru/api/auth/callback
FRONTEND_URL=https://upme.–≤–∞—à-–¥–æ–º–µ–Ω.ru
HF_API_KEY=–≤–∞—à_key
NODE_ENV=production
DATABASE_PATH=/var/www/upme/backend/data/upme.db
```

### –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```bash
mkdir -p /var/www/upme/backend/data
mkdir -p /var/www/upme/backend/logs
chmod 755 /var/www/upme/backend/data
chmod 755 /var/www/upme/backend/logs
```

### –®–∞–≥ 6: –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
cd /var/www/upme/backend
npm run migrate
```

### –®–∞–≥ 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PM2 –¥–ª—è –¥–≤—É—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ/–æ–±–Ω–æ–≤–∏—Ç–µ `ecosystem.config.js` –≤ –∫–æ—Ä–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞:

```javascript
module.exports = {
  apps: [
    {
      name: 'project1',
      script: './var/www/project1/–≤–∞—à-—Å–∫—Ä–∏–ø—Ç.js',
      cwd: '/var/www/project1',
      instances: 1,
      exec_mode: 'fork',
      env: {
        NODE_ENV: 'production',
        PORT: 3001
      },
      error_file: './logs/project1-error.log',
      out_file: './logs/project1-out.log',
      autorestart: true,
      watch: false
    },
    {
      name: 'upme-backend',
      script: './backend/dist/index.js',
      cwd: '/var/www/upme',
      instances: 1,
      exec_mode: 'fork',
      env: {
        NODE_ENV: 'production',
        PORT: 3002
      },
      error_file: './logs/upme-error.log',
      out_file: './logs/upme-out.log',
      autorestart: true,
      watch: false,
      max_memory_restart: '300M'
    }
  ]
};
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±–∞ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
pm2 start ecosystem.config.js
pm2 save
pm2 startup
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:

```bash
pm2 status
pm2 logs
```

### –®–∞–≥ 8: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –¥–ª—è –¥–≤—É—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

–°–æ–∑–¥–∞–π—Ç–µ/–æ–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx:

```bash
sudo nano /etc/nginx/sites-available/default
```

–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:

```bash
# –î–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
sudo nano /etc/nginx/sites-available/project1

# –î–ª—è UpMe
sudo nano /etc/nginx/sites-available/upme
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è UpMe** (`/etc/nginx/sites-available/upme`):

```nginx
server {
    listen 80;
    server_name upme.–≤–∞—à-–¥–æ–º–µ–Ω.ru;

    # –õ–æ–≥–∏
    access_log /var/log/nginx/upme-access.log;
    error_log /var/log/nginx/upme-error.log;

    # Backend API
    location /api {
        proxy_pass http://localhost:3002;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        
        # –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è AI –∑–∞–ø—Ä–æ—Å–æ–≤
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
    }

    # Frontend —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
    location / {
        root /var/www/upme/frontend/dist;
        try_files $uri $uri/ /index.html;
        
        # –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }
}
```

–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```bash
sudo ln -s /etc/nginx/sites-available/upme /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### –®–∞–≥ 9: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DNS –¥–ª—è –ø–æ–¥–¥–æ–º–µ–Ω–∞

–í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–∏–º –¥–æ–º–µ–Ω–æ–º:

1. –î–æ–±–∞–≤—å—Ç–µ A-–∑–∞–ø–∏—Å—å:
   - **–ò–º—è**: `upme` (–∏–ª–∏ `@` –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–º–µ–Ω)
   - **–¢–∏–ø**: `A`
   - **–ó–Ω–∞—á–µ–Ω–∏–µ**: IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
   - **TTL**: `3600`

2. –ò–ª–∏ CNAME –∑–∞–ø–∏—Å—å:
   - **–ò–º—è**: `upme`
   - **–¢–∏–ø**: `CNAME`
   - **–ó–Ω–∞—á–µ–Ω–∏–µ**: `–≤–∞—à-–¥–æ–º–µ–Ω.ru`

### –®–∞–≥ 10: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL –¥–ª—è –ø–æ–¥–¥–æ–º–µ–Ω–∞

```bash
sudo certbot --nginx -d upme.–≤–∞—à-–¥–æ–º–µ–Ω.ru
```

–ò–ª–∏ –µ—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞:

```bash
sudo certbot --nginx -d –≤–∞—à-–¥–æ–º–µ–Ω.ru -d upme.–≤–∞—à-–¥–æ–º–µ–Ω.ru
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
# CPU –∏ RAM
htop

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤
sudo netstat -tlnp | grep -E '3001|3002'

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h

# PM2 –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 monit
```

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ PM2

–î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–∏–º–∏—Ç—ã:

```javascript
{
  name: 'upme-backend',
  // ...
  max_memory_restart: '300M',  // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 300MB
  min_uptime: '10s',
  max_restarts: 10
}
```

---

## –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:

**–ü—Ä–æ–µ–∫—Ç 1 (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π):**
- RAM: ~100-200 MB
- CPU: 10-20%

**UpMe:**
- RAM: ~150-250 MB
- CPU: 5-15%

**–°–∏—Å—Ç–µ–º–∞:**
- RAM: ~200-300 MB
- CPU: 5-10%

**–ò—Ç–æ–≥–æ:**
- RAM: ~450-750 MB –∏–∑ 2 GB (22-37%)
- CPU: ~20-45% –∏–∑ 100%
- **–í—ã–≤–æ–¥**: –†–µ—Å—É—Ä—Å–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ! ‚úÖ

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UpMe:

```bash
cd /var/www/upme
git pull  # –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã
cd backend
npm install --production
npm run build
pm2 restart upme-backend
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
cd /var/www/project1
# –≤–∞—à–∏ –∫–æ–º–∞–Ω–¥—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
pm2 restart project1
```

---

## Troubleshooting

### –û—à–∏–±–∫–∞: "Port already in use"

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∫–∞–∫–∏–µ –ø–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã
sudo lsof -i :3001
sudo lsof -i :3002

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç
pm2 stop project1
pm2 stop upme-backend
```

### –û—à–∏–±–∫–∞: "Cannot find module"

```bash
# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
cd /var/www/upme/backend
rm -rf node_modules
npm install --production
```

### –û—à–∏–±–∫–∞: "Database locked"

SQLite –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ë–î
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: `chmod 644 /var/www/upme/backend/data/upme.db`

### –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
free -h
pm2 monit

# –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à
pm2 flush

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç—ã
pm2 restart all
```

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤:

```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ crontab
crontab -e

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
*/5 * * * * free -h >> /var/log/memory-usage.log
```

### 2. –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–æ—Ç–∞—Ü–∏—é, —á—Ç–æ–±—ã –ª–æ–≥–∏ –Ω–µ –∑–∞–Ω–∏–º–∞–ª–∏ –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞:

```bash
sudo nano /etc/logrotate.d/pm2
```

```
/var/www/*/logs/*.log {
    daily
    rotate 7
    compress
    missingok
    notifempty
}
```

### 3. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±—ç–∫–∞–ø—ã –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:

```bash
#!/bin/bash
# /root/backup-all.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup"

# –ë—ç–∫–∞–ø –ø—Ä–æ–µ–∫—Ç–∞ 1
tar -czf $BACKUP_DIR/project1_$DATE.tar.gz /var/www/project1

# –ë—ç–∫–∞–ø UpMe
tar -czf $BACKUP_DIR/upme_$DATE.tar.gz /var/www/upme

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (—Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π)
find $BACKUP_DIR -name "*.tar.gz" -mtime +7 -delete
```

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
–°–µ—Ä–≤–µ—Ä (2 GB RAM, 1 CPU, 14 GB SSD)
‚îÇ
‚îú‚îÄ‚îÄ –ü—Ä–æ–µ–∫—Ç 1
‚îÇ   ‚îú‚îÄ‚îÄ –ü–æ—Ä—Ç: 3001
‚îÇ   ‚îú‚îÄ‚îÄ –î–æ–º–µ–Ω: –≤–∞—à-–¥–æ–º–µ–Ω.ru
‚îÇ   ‚îú‚îÄ‚îÄ RAM: ~100-200 MB
‚îÇ   ‚îî‚îÄ‚îÄ CPU: 10-20%
‚îÇ
‚îî‚îÄ‚îÄ UpMe
    ‚îú‚îÄ‚îÄ –ü–æ—Ä—Ç: 3002
    ‚îú‚îÄ‚îÄ –î–æ–º–µ–Ω: upme.–≤–∞—à-–¥–æ–º–µ–Ω.ru
    ‚îú‚îÄ‚îÄ RAM: ~150-250 MB
    ‚îî‚îÄ‚îÄ CPU: 5-15%
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:**
- RAM: ~450-750 MB / 2048 MB (22-37%) ‚úÖ
- CPU: ~20-45% / 100% ‚úÖ
- –î–∏—Å–∫: ~6-8 GB / 14 GB (43-57%) ‚úÖ

**–í—ã–≤–æ–¥: –†–µ—Å—É—Ä—Å–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤!** üéâ

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
pm2 status

# –õ–æ–≥–∏ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
pm2 logs

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
pm2 logs upme-backend
pm2 logs project1

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö
pm2 restart all

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ
pm2 restart upme-backend

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 monit

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Nginx
sudo nginx -t
sudo systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
sudo netstat -tlnp | grep -E '3001|3002'
```

---

–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –¥–≤–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ. üöÄ

